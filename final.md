小组成员：



#### 数据库

##### MySQL:zyk, wrh

在前期经过调研之后，我们决定使用`MySQL` 。

**[这里需要吹一波MySQL]** (zyx)

**PEEWEE:zyk, wrh**

使用Python ORM Peewee来操作数据库

**[这里需要吹一波ORM和Peewee]** (zyx)

接下来对数据库中各个TABLE逐一进行说明。

##### user

##### post

##### post_file

##### reply

##### collects

##### likes



#### 功能部分

本次后端主要使用`python` ，以`flask`作为Web应用框架。实现了社交网络的基本功能。

**[这里需要吹一波Flask]**  (zyx)

接下来对本网站实现的功能进行详细说明。



##### 用户管理

###### 注册:zyk ,xqm

注册步骤

1. 点击首页左上角的注册按钮进入注册界面。

1. 依次填写用户名、昵称、邮箱、密码、验证码。其中密码需要连续输入两次进行确认。
2. 若填写均无误，点击提交，即可注册完毕。

实现说明：

[前端接口说明]

后端利用`get_register_info()`函数，从`request`中解析出用户输入的`username`，`password`，`nickname`，`email`，`imagecode`。如果一切都是合法的，那么在数据库中的user表总插入对应表项，并自动转到登录界面。其中若未输入昵称，则默认昵称就是用户名。

若不合法，则回到注册界面并显示响应错误提示。可能出现的错误有：

1. 未输入用户名、密码、电子邮件

2. 用户名和已经注册用户重名

3. 两次输入的密码不匹配

4. 验证码错误

5. 用户名或昵称过长(超过40个字符)

这里不直接存取`password` ，而是使用`werkzeug.security`中的`generate_password_hash`函数，计算出`password`的哈希值，最后将该哈希值存储在数据库中。如此就算数据库中的数据出现泄漏，也可以保障用户的密码信息这个关键信息不被泄漏。

###### 登录:  zyk ,xqm

[前端说明]

登录步骤

1. 点击首页左上角的登录按钮进入登录界面，注册完毕之后也会自动跳转到登录界面
2. 输入用户名，密码，验证码
3. 若用户名已被注册且密码正确，则进入主界面，同时在主界面中显示

如果在数据库中没有找到匹配的用户名，则回到登录界面并显示“用户名不存在”。

如果输入的验证码错误，回到登录界面并显示“验证码错误”。

由于在数据库中存储的是注册时使用密码的哈希值，因此登录时检查密码是否匹配的过程具体如下：利用同样的哈希函数为输入的密码生成哈希值，若此哈希值和数据库中存储的哈希值相同，则认为输入的密码是正确的。否则，回到登录界面并显示“密码不正确”。

###### 验证码: wrh



###### 个人主页:wrh, xqm

[前端说明]

后端利用`get_home_info()`函数，分别在`user table`、`posts table`和`collects table`中获取用户信息、用户发过的贴子和用户收藏的贴子。



###### 个人设置:wrh, xqm

[前端说明]

后端利用`set_name()`、`set_mail()`和`set_pass()`三个函数，分别更改用户昵称、邮箱和密码。



##### 贴子管理

###### 主界面：wrh, xqm(包括精品贴子的实现)



###### 热贴：wrh，xqm



###### 发贴:wrh



###### 文件:zyk, xqm

后端可以通过前端获得用户想要上传的文件的内容、文件名等文件信息。

###### 回复:wrh,xqm



##### 搜索功能：wrh, xqm

[前端说明]

使用`like()`语句进行匹配，要搜索的关键词是ST，那么在`like()`中的关键词前后要加通配符`%`。具体可见`title_search()`函数和`user_search()`函数。



##### 管理员界面：zyk, zyx

###### 置顶

###### 禁言

